name: Create Release

on:
  # pull_request:
  #   types:
  #     -closed
  workflow_dispatch:

jobs:
  create_release:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Get next version
        uses: reecetech/version-increment@2023.4.1
        id: version
        with:
          scheme: semver
          increment: patch
      - name: Create Release
        uses: softprops/action-gh-release@v0.1.15
        if: github.event.pull_request.merged == true || github.event_name == 'workflow_dispatch'
        id: release
        with:
          name: Release ${{ steps.version.outputs.version }}
          tag_name: ${{ steps.version.outputs.v-version }}
          generate_release_notes: true
      - name: DEBUG
        shell: bash
        if: github.event.pull_request.merged == true || github.event_name == 'workflow_dispatch'
        env:
          NEXT_VERSION: ${{ steps.version.outputs.version }}
          NEXT_VERSION_TAG: ${{ steps.version.outputs.v-version }}
          RELEASE_URL: ${{ steps.release.outputs.url }}
        run: |
          echo "NEXT_VERSION: $NEXT_VERSION"
          echo "NEXT_VERSION_TAG: $NEXT_VERSION_TAG"
          echo "RELEASE_URL: ${RELEASE_URL}"

